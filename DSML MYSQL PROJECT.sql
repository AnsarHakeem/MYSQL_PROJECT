CREATE DATABASE LIBRARY;
USE LIBRARY;

CREATE TABLE BRANCH(BRANCH_NUMBER INT PRIMARY KEY,
MANAGER_ID INT,
BRANCH_ADDRESS VARCHAR(50),
CONTACT_NO BIGINT);

CREATE TABLE EMPLOYEE(EMP_ID INT PRIMARY KEY,
EMP_NAME VARCHAR(30),
POSITION CHAR (20),
SALARY BIGINT,
BRANCH_NO INT, FOREIGN KEY(BRANCH_NO) REFERENCES BRANCH(BRANCH_NUMBER));

CREATE TABLE BOOKS(ISBN BIGINT PRIMARY KEY,
BOOK_TITLE VARCHAR(50),
CATEGORY VARCHAR(40),
RENTAL_PRICE INT,
STATUS CHAR(15),
AUTHOR VARCHAR(30),
PUBLISHER VARCHAR(50));

CREATE TABLE CUSTOMER(CUSTOMER_ID INT PRIMARY KEY,
CUSTOMER_NAME VARCHAR(30),
CUSTOMER_ADDRESS VARCHAR(50),
REG_DATE DATETIME);

CREATE TABLE ISSUESTATUS(ISSUE_ID INT PRIMARY KEY,
ISSUED_CUST INT, FOREIGN KEY(ISSUED_CUST) REFERENCES CUSTOMER(CUSTOMER_ID),
ISSUED_BOOK_NAME VARCHAR(50),
ISSUE_DATE DATETIME,
ISBN_BOOK BIGINT, FOREIGN KEY(ISBN_BOOK) REFERENCES BOOKS(ISBN));

CREATE TABLE RETURNSTATUS(RETURN_ID INT PRIMARY KEY,
RETURN_CUST VARCHAR(30),
RETURN_BOOK_NAME VARCHAR(50),
RETURN_DATE DATETIME,
ISBN_BOOK2 BIGINT, FOREIGN KEY(ISBN_BOOK2) REFERENCES BOOKS(ISBN));

INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(1,012,'KOCHI BRANCH','9909864350');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(2,020,'AROOR BRANCH','9809864345');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(3,128,'ALUVA BRANCH','9909864360');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(4,002,'KOCHI BRANCH','9909864450');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(5,011,'KOCHI BRANCH','9909864351');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(6,015,'KOCHI BRANCH','9909864453');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(7,102,'KOCHI BRANCH','9909864359');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(8,052,'KOCHI BRANCH','9909864460');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(9,112,'KOCHI BRANCH','9909864576');
INSERT INTO BRANCH(BRANCH_NUMBER,MANAGER_ID,BRANCH_ADDRESS,CONTACT_NO)
VALUES(10,220,'KOCHI BRANCH','9809866650');

INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(231,'AMAL','SALES','26000',4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(232,'AMINA','MARKETING','30000',4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(233,'HARI','MARKETING','33000',3);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(234,'KAVYA','SALES','24000',6);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(235,'MANIKANDAN','SALES','20000',9);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(236,'RAGHU','EDITING','40000',4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(237,'ANNA','PRODUCTION','34000',6);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(238,'VARGHESE','SALES','26000',3);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(239,'ANTONY','MARKETING','28500',4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(240,'MAHESH','SALES','25000',7);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(241,'RAGHAV','PRODUCTION','36000',5);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(242,'AKHIL','EDITING','42000',7);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(243,'AMEER','MARKETING','32000',4);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(244,'ANAGHA','PRODUCTION','35000',1);
INSERT INTO EMPLOYEE(EMP_ID,EMP_NAME,POSITION,SALARY,BRANCH_NO)
VALUES(245,'ARUN','EDITING','45000',2);

INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(8749522310,'ALICE IN WONDERLAND','FANTASY',450,'YES','LEWIS CARROL','MACMILLAN');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(8886001600,'ANCIENT MARINER','POEM',650,'NO','COLERIDGE','J&A ARCH');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(0451526341,'ANIMAL FARM','PLOITICAL SATIRE',350,'YES','GEORGE ORWELL','SECKER AND WARBURG');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(145388632,'DAS KAPITAL','POLITICS',650,'YES','KARL MARX','VERLAG VON OTTO MEISNER');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(0553213512,'TIME MACHINE','SCIENCE FICTION',350,'NO','H.G.WELLS','WILLIAM HEIGNEMANN');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(1954525915,'A PASSAGE TO INDIA','NOVEL',750,'YES','E.M.FORSTER','EDWARD ARNOLD');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(8181920333,'AVIGYAN SAKUNDALAM','ROMANTIC DRAMA',750,'YES','KALIDAS','CHAUKAMBA SANSKRIT PRATHISHTHAN');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(0143031031,'DISCOVERY OF INDIA','HISTORY',850,'YES','JAWAHARLAL NEHRU','JOHN DAY');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(8437075297,'ORIGIN OF SPECIES','SCIENTIFIC LITERATURE',550,'NO','CHARLES DARWIN','JOHN MURRAY');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(0486245934,'MY EXPERIMENT WITH TRUTH','AUTOBIOGRAPHY',1000,'YES','MAHATMA M.K GANDHI','DOVER PUBLICATIONS');
INSERT INTO BOOKS(ISBN,BOOK_TITLE,CATEGORY,RENTAL_PRICE,STATUS,AUTHOR,PUBLISHER)
VALUES(9781625584106,'GEETANJALI','POEM',850,'YES','RABINDRA NATH TAGORE','RUPA');

INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(201,'ANANDU','M1-ALUVA','2016-08-12');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(345,'ALEENA','CM3-THIROOR','2021-06-09');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(350,'RAVI','CC4-AROOR','2022-04-09');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(230,'ARJUN','THY8-VYTTILA','2019-07-08');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(400,'NEWTON','TRA8-ALAPPUZHA','2023-06-01');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(450,'RINI','YRA7-TVM','2023-09-12');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(347,'REENU','YRA4-TVM','2017-06-01');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(102,'FAROOQ','YBH12-KOCHI','2009-08-03');
INSERT INTO CUSTOMER(CUSTOMER_ID,CUSTOMER_NAME,CUSTOMER_ADDRESS,REG_DATE)
VALUES(500,'THILAK','NHI55-KOCHI','2023-09-05');

INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(132,500,'MY EXPERIMENT WITH TRUTH','2023-12-08',0486245934);
INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(130,347,'GEETANJALI','2022-10-09',9781625584106);
INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(110,345,'ALICE IN WONDERLAND','2022-01-04',8749522310);
INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(133,102,'MY EXPERIMENT WITH TRUTH','2010-03-28',0486245934);
INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(170,201,'DAS KAPITAL','2019-06-30',145388632);
INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(140,450,'A PASSAGE TO INDIA','2024-03-14',1954525915);
INSERT INTO ISSUESTATUS(ISSUE_ID,ISSUED_CUST,ISSUED_BOOK_NAME,ISSUE_DATE,ISBN_BOOK)
VALUES(158,400,'ANIMAL FARM','2023-12-24',0451526341);

INSERT INTO RETURNSTATUS(RETURN_ID,RETURN_CUST,RETURN_BOOK_NAME,RETURN_DATE,ISBN_BOOK2)
VALUES(220,'FAROOQ','MY EXPERIMENT WITH TRUTH','2012-12-06',0486245934);
INSERT INTO RETURNSTATUS(RETURN_ID,RETURN_CUST,RETURN_BOOK_NAME,RETURN_DATE,ISBN_BOOK2)
VALUES(240,'RINI','A PASSAGE TO INDIA','2024-05-28',1954525915);
INSERT INTO RETURNSTATUS(RETURN_ID,RETURN_CUST,RETURN_BOOK_NAME,RETURN_DATE,ISBN_BOOK2)
VALUES(236,'REENU','DAS KAPITAL','2019-12-24',145388632);
INSERT INTO RETURNSTATUS(RETURN_ID,RETURN_CUST,RETURN_BOOK_NAME,RETURN_DATE,ISBN_BOOK2)
VALUES(239,'THILAK','MY EXPERIMENT WITH TRUTH','2024-04-30',0486245934);
INSERT INTO RETURNSTATUS(RETURN_ID,RETURN_CUST,RETURN_BOOK_NAME,RETURN_DATE,ISBN_BOOK2)
VALUES(225,'ALEENA','ALICE IN WONDERLAND','2022-08-18',8749522310);

SELECT BOOK_TITLE,CATEGORY,RENTAL_PRICE FROM BOOKS WHERE STATUS='YES';

SELECT EMP_NAME,SALARY FROM EMPLOYEE ORDER BY SALARY DESC;

SELECT ISSUED_BOOK_NAME,ISSUED_CUST FROM ISSUESTATUS;

SELECT CATEGORY,COUNT(BOOK_TITLE) FROM BOOKS GROUP BY CATEGORY;

SELECT EMP_NAME,POSITION FROM EMPLOYEE WHERE SALARY>50000;

SELECT CUSTOMER_NAME FROM CUSTOMER WHERE REG_DATE<'2022-01-01'
AND CUSTOMER_ID NOT IN(SELECT ISSUED_CUST FROM ISSUESTATUS);

SELECT BRANCH_NO,COUNT(EMP_ID) FROM EMPLOYEE INNER JOIN BRANCH ON BRANCH_NUMBER=BRANCH_NUMBER
GROUP BY BRANCH_NO;

SELECT CUSTOMER_NAME FROM CUSTOMER INNER JOIN ISSUESTATUS ON ISSUE_ID=ISSUE_ID
WHERE month(ISSUE_DATE)=6 AND YEAR(ISSUE_DATE)=2023;

SELECT BOOK_TITLE FROM BOOKS WHERE CATEGORY='HISTORY';

SELECT BRANCH_ADDRESS,COUNT(EMP_ID) AS EMPLOYEE_COUNT FROM EMPLOYEE INNER JOIN BRANCH ON BRANCH_NUMBER=BRANCH_NUMBER
GROUP BY BRANCH_ADDRESS HAVING COUNT(EMP_ID)>5
ORDER BY EMPLOYEE_COUNT DESC;

SELECT BRANCH_NUMBER,BRANCH_ADDRESS FROM BRANCH INNER JOIN EMPLOYEE ON EMP_ID=MANAGER_ID;

SELECT CUSTOMER_NAME FROM CUSTOMER INNER JOIN ISSUESTATUS ON ISSUED_CUST=ISSUED_CUST
 INNER JOIN BOOKS ON ISBN=ISBN WHERE RENTAL_PRICE>25;

